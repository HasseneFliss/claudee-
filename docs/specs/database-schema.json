{
  "tables": [
    {
      "name": "users",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "email",
          "type": "VARCHAR(255)",
          "nullable": false,
          "unique": true
        },
        {
          "name": "password_hash",
          "type": "VARCHAR(255)",
          "nullable": false
        },
        {
          "name": "first_name",
          "type": "VARCHAR(50)",
          "nullable": false
        },
        {
          "name": "last_name",
          "type": "VARCHAR(50)",
          "nullable": false
        },
        {
          "name": "phone",
          "type": "VARCHAR(20)",
          "nullable": true
        },
        {
          "name": "date_of_birth",
          "type": "DATE",
          "nullable": true
        },
        {
          "name": "avatar",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "email_verified",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "is_active",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "role",
          "type": "VARCHAR(20)",
          "nullable": false,
          "default": "user"
        },
        {
          "name": "last_login",
          "type": "TIMESTAMP",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "email"
          ],
          "unique": true
        },
        {
          "columns": [
            "role"
          ],
          "unique": false
        }
      ],
      "foreignKeys": []
    },
    {
      "name": "products",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "name",
          "type": "VARCHAR(255)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "TEXT",
          "nullable": true
        },
        {
          "name": "price",
          "type": "DECIMAL(10,2)",
          "nullable": false
        },
        {
          "name": "original_price",
          "type": "DECIMAL(10,2)",
          "nullable": true
        },
        {
          "name": "discount",
          "type": "DECIMAL(5,2)",
          "nullable": true,
          "default": "0"
        },
        {
          "name": "currency",
          "type": "VARCHAR(3)",
          "nullable": false,
          "default": "USD"
        },
        {
          "name": "image_url",
          "type": "VARCHAR(500)",
          "nullable": false
        },
        {
          "name": "image_urls",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "category_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "brand_id",
          "type": "UUID",
          "nullable": true
        },
        {
          "name": "rating",
          "type": "DECIMAL(3,2)",
          "nullable": true,
          "default": "0"
        },
        {
          "name": "review_count",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "in_stock",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "stock_count",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "tags",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "featured",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "specifications",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "category_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "brand_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "price"
          ],
          "unique": false
        },
        {
          "columns": [
            "rating"
          ],
          "unique": false
        },
        {
          "columns": [
            "featured"
          ],
          "unique": false
        },
        {
          "columns": [
            "in_stock"
          ],
          "unique": false
        },
        {
          "columns": [
            "name"
          ],
          "unique": false,
          "type": "gin"
        },
        {
          "columns": [
            "created_at"
          ],
          "unique": false
        }
      ],
      "foreignKeys": [
        {
          "column": "category_id",
          "references": "categories(id)",
          "onDelete": "RESTRICT"
        },
        {
          "column": "brand_id",
          "references": "brands(id)",
          "onDelete": "SET NULL"
        }
      ]
    },
    {
      "name": "categories",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "name",
          "type": "VARCHAR(100)",
          "nullable": false
        },
        {
          "name": "slug",
          "type": "VARCHAR(100)",
          "nullable": false,
          "unique": true
        },
        {
          "name": "description",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "image_url",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "parent_id",
          "type": "UUID",
          "nullable": true
        },
        {
          "name": "featured",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "sort_order",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "slug"
          ],
          "unique": true
        },
        {
          "columns": [
            "parent_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "featured"
          ],
          "unique": false
        },
        {
          "columns": [
            "sort_order"
          ],
          "unique": false
        }
      ],
      "foreignKeys": [
        {
          "column": "parent_id",
          "references": "categories(id)",
          "onDelete": "SET NULL"
        }
      ]
    },
    {
      "name": "brands",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "name",
          "type": "VARCHAR(100)",
          "nullable": false
        },
        {
          "name": "slug",
          "type": "VARCHAR(100)",
          "nullable": false,
          "unique": true
        },
        {
          "name": "description",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "logo_url",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "website_url",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "slug"
          ],
          "unique": true
        },
        {
          "columns": [
            "name"
          ],
          "unique": false
        }
      ],
      "foreignKeys": []
    },
    {
      "name": "product_variants",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "product_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "name",
          "type": "VARCHAR(255)",
          "nullable": false
        },
        {
          "name": "price",
          "type": "DECIMAL(10,2)",
          "nullable": false
        },
        {
          "name": "sku",
          "type": "VARCHAR(100)",
          "nullable": true,
          "unique": true
        },
        {
          "name": "attributes",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "in_stock",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "stock_count",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "product_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "sku"
          ],
          "unique": true
        }
      ],
      "foreignKeys": [
        {
          "column": "product_id",
          "references": "products(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "product_reviews",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "product_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "user_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "user_name",
          "type": "VARCHAR(100)",
          "nullable": false
        },
        {
          "name": "rating",
          "type": "INTEGER",
          "nullable": false,
          "check": "rating >= 1 AND rating <= 5"
        },
        {
          "name": "comment",
          "type": "TEXT",
          "nullable": false
        },
        {
          "name": "verified",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "helpful",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "product_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "rating"
          ],
          "unique": false
        },
        {
          "columns": [
            "created_at"
          ],
          "unique": false
        }
      ],
      "foreignKeys": [
        {
          "column": "product_id",
          "references": "products(id)",
          "onDelete": "CASCADE"
        },
        {
          "column": "user_id",
          "references": "users(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "carts",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "user_id",
          "type": "UUID",
          "nullable": false,
          "unique": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "user_id"
          ],
          "unique": true
        }
      ],
      "foreignKeys": [
        {
          "column": "user_id",
          "references": "users(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "cart_items",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "cart_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "product_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "variant_id",
          "type": "UUID",
          "nullable": true
        },
        {
          "name": "quantity",
          "type": "INTEGER",
          "nullable": false,
          "check": "quantity > 0"
        },
        {
          "name": "price",
          "type": "DECIMAL(10,2)",
          "nullable": false
        },
        {
          "name": "added_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "cart_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "product_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "cart_id",
            "product_id",
            "variant_id"
          ],
          "unique": true
        }
      ],
      "foreignKeys": [
        {
          "column": "cart_id",
          "references": "carts(id)",
          "onDelete": "CASCADE"
        },
        {
          "column": "product_id",
          "references": "products(id)",
          "onDelete": "CASCADE"
        },
        {
          "column": "variant_id",
          "references": "product_variants(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "wishlists",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "user_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "product_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "added_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "product_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "user_id",
            "product_id"
          ],
          "unique": true
        },
        {
          "columns": [
            "added_at"
          ],
          "unique": false
        }
      ],
      "foreignKeys": [
        {
          "column": "user_id",
          "references": "users(id)",
          "onDelete": "CASCADE"
        },
        {
          "column": "product_id",
          "references": "products(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "banners",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "title",
          "type": "VARCHAR(200)",
          "nullable": false
        },
        {
          "name": "subtitle",
          "type": "VARCHAR(300)",
          "nullable": true
        },
        {
          "name": "description",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "image_url",
          "type": "VARCHAR(500)",
          "nullable": false
        },
        {
          "name": "mobile_image_url",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "link_url",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "link_text",
          "type": "VARCHAR(50)",
          "nullable": true
        },
        {
          "name": "position",
          "type": "VARCHAR(20)",
          "nullable": false,
          "check": "position IN ('hero', 'secondary', 'sidebar')"
        },
        {
          "name": "active",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "start_date",
          "type": "TIMESTAMP",
          "nullable": true
        },
        {
          "name": "end_date",
          "type": "TIMESTAMP",
          "nullable": true
        },
        {
          "name": "sort_order",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "position"
          ],
          "unique": false
        },
        {
          "columns": [
            "active"
          ],
          "unique": false
        },
        {
          "columns": [
            "sort_order"
          ],
          "unique": false
        },
        {
          "columns": [
            "start_date",
            "end_date"
          ],
          "unique": false
        }
      ],
      "foreignKeys": []
    },
    {
      "name": "user_preferences",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "user_id",
          "type": "UUID",
          "nullable": false,
          "unique": true
        },
        {
          "name": "view_mode",
          "type": "VARCHAR(10)",
          "nullable": false,
          "default": "grid",
          "check": "view_mode IN ('grid', 'list')"
        },
        {
          "name": "items_per_page",
          "type": "INTEGER",
          "nullable": false,
          "default": "20",
          "check": "items_per_page IN (20, 40, 60)"
        },
        {
          "name": "default_sort",
          "type": "VARCHAR(20)",
          "nullable": false,
          "default": "created_at"
        },
        {
          "name": "default_sort_order",
          "type": "VARCHAR(4)",
          "nullable": false,
          "default": "desc",
          "check": "default_sort_order IN ('asc', 'desc')"
        },
        {
          "name": "saved_filters",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "currency",
          "type": "VARCHAR(3)",
          "nullable": false,
          "default": "USD"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "user_id"
          ],
          "unique": true
        }
      ],
      "foreignKeys": [
        {
          "column": "user_id",
          "references": "users(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "refresh_tokens",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "user_id",
          "type": "UUID",
          "nullable": false
        },
        {
          "name": "token",
          "type": "VARCHAR(255)",
          "nullable": false,
          "unique": true
        },
        {
          "name": "expires_at",
          "type": "TIMESTAMP",
          "nullable": false
        },
        {
          "name": "revoked",
          "type": "BOOLEAN",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "token"
          ],
          "unique": true
        },
        {
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "expires_at"
          ],
          "unique": false
        }
      ],
      "foreignKeys": [
        {
          "column": "user_id",
          "references": "users(id)",
          "onDelete": "CASCADE"
        }
      ]
    },
    {
      "name": "search_suggestions",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "text",
          "type": "VARCHAR(255)",
          "nullable": false
        },
        {
          "name": "type",
          "type": "VARCHAR(20)",
          "nullable": false,
          "check": "type IN ('product', 'category', 'brand', 'query')"
        },
        {
          "name": "count",
          "type": "INTEGER",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "image_url",
          "type": "VARCHAR(500)",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "text"
          ],
          "unique": false,
          "type": "gin"
        },
        {
          "columns": [
            "type"
          ],
          "unique": false
        },
        {
          "columns": [
            "count"
          ],
          "unique": false
        }
      ],
      "foreignKeys": []
    },
    {
      "name": "analytics_events",
      "columns": [
        {
          "name": "id",
          "type": "UUID",
          "primary": true,
          "default": "gen_random_uuid()"
        },
        {
          "name": "event_type",
          "type": "VARCHAR(50)",
          "nullable": false
        },
        {
          "name": "timestamp",
          "type": "TIMESTAMP",
          "nullable": false
        },
        {
          "name": "user_id",
          "type": "UUID",
          "nullable": true
        },
        {
          "name": "session_id",
          "type": "VARCHAR(100)",
          "nullable": true
        },
        {
          "name": "product_id",
          "type": "UUID",
          "nullable": true
        },
        {
          "name": "category_id",
          "type": "UUID",
          "nullable": true
        },
        {
          "name": "search_query",
          "type": "VARCHAR(255)",
          "nullable": true
        },
        {
          "name": "filters",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "sort_by",
          "type": "VARCHAR(50)",
          "nullable": true
        },
        {
          "name": "view_mode",
          "type": "VARCHAR(10)",
          "nullable": true
        },
        {
          "name": "device_type",
          "type": "VARCHAR(10)",
          "nullable": true,
          "check": "device_type IN ('mobile', 'tablet', 'desktop')"
        },
        {
          "name": "metadata",
          "type": "JSON",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "default": "NOW()"
        }
      ],
      "indexes": [
        {
          "columns": [
            "event_type"
          ],
          "unique": false
        },
        {
          "columns": [
            "timestamp"
          ],
          "unique": false
        },
        {
          "columns": [
            "user_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "session_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "product_id"
          ],
          "unique": false
        },
        {
          "columns": [
            "category_id"
          ],
          "unique": false
        }
      ],
      "foreignKeys": [
        {
          "column": "user_id",
          "references": "users(id)",
          "onDelete": "SET NULL"
        },
        {
          "column": "product_id",
          "references": "products(id)",
          "onDelete": "SET NULL"
        },
        {
          "column": "category_id",
          "references": "categories(id)",
          "onDelete": "SET NULL"
        }
      ]
    }
  ]
}